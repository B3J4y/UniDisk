<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:func="http://example.com/functions"
      xmlns:c="http://java.sun.com/jsp/jstl/core">

<h:head>
    <meta charset="utf-8"></meta>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no"></meta>
    <title>UniDisk</title>
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css"></link>
    <link rel="stylesheet" href="/assets/css/styles.min.css?h=c1c875adbe3423b81e6840c89217b6d0"></link>

</h:head>

<h:body>

    <h:outputStylesheet library="css" name="styles.css"  />

    <ui:include src="header.xhtml"/>

    <p:dialog header="Neues Projekt" widgetVar="dlg2" modal="true" resizable="false" draggable="false">
       <h:form id="projectDialogForm">
           <p:panelGrid columns="1" layout="grid"  styleClass="ui-noborder">
            <p:remoteCommand name="addProject" update="dataTableForm projectDialogForm" actionListener="#{addProjectDialog.onAddNew(addProjectDialog.newProjectText)}"/>
            <p:inputText id="projectNameInput"  placeholder="Projektname..." value="#{addProjectDialog.newProjectText}"
                         onkeypress="if (event.keyCode == 13) { addProject(); return false; }"
            />
            <h:outputText id="projectDialogError" value="#{addProjectDialog.errorText}" />
           </p:panelGrid>
            <p:panelGrid columns="2" layout="grid"  styleClass="ui-noborder">
            <p:commandButton value="Abbrechen"
                             action="#{addProjectDialog.reset()}"
                             update="projectDialogForm" onclick="PF('dlg2').hide();"/>
            <p:commandButton value="Anlegen" styleClass="ui-priority-primary"
                             action="#{addProjectDialog.onAddNew(addProjectDialog.newProjectText)}"
                             update="projectNameInput projectDialogError dataTableForm"/>
            </p:panelGrid>
       </h:form>
    </p:dialog>

    <ui:include src="components/projects/DeleteProjectDialog.xhtml">
        <ui:param name="updateOnDelete" value="dataTableForm stichwortPanel" />
    </ui:include>

    <!-- the data table -->
    <div class="row">
        <div class="col-lg-3">
            <div class="col-lg-12">
                <p:panelGrid columns="2" styleClass="ui-noborder">
                <h3>Projekt√ºbersicht</h3>
                <p:commandButton value="+" type="button" update=":projectDialogForm" onclick="PF('dlg2').show();" />
                </p:panelGrid>
                <h:form id="dataTableForm">
                    <p:growl id="msgs" showDetail="true"/>

                    <p:dataTable id="projects1" widgetVar="projects1" var="project" value="#{dtAddRowView.projects}"
                                 editable="false"
                                 emptyMessage="Keine Projekte vorhanden"
                                 style="margin-bottom:20px">

                        <p:column headerText="Meine Projekte">
                            <p:link outcome="project" value="#{project.name}">
                                <f:param name="projectId" value="#{project.id}" />
                            </p:link>
                            <h:graphicImage library="images" style="height: 30px; width: 30px; margin-left: 16px; margin-right: 16px;" name="#{func:getStateIconUrl(project.status)}"/>
                            <div style="float:right;">
                            <p:commandButton value="-" id="deleteButton"
                                             update="dataTableForm stichwortPanel projectTopicHeader"
                                             onclick="PF('projectDeleteDialog').show();"
                                             action="#{deleteProjectDialog.setup(project.name,project.id)}" style="margin-right:20px;"
                                             styleClass="ui-priority-primary">
                                <!-- <f:actionListener binding="#{projectTopicTable.setSelectedTopic(null)}" /> -->
                            </p:commandButton>
                            <p:commandButton value="Details" id="projectDetailButton"
                                             update="stichwortPanel projectTopicHeader"
                                             action="#{projectTopicTable.setProject(project.id)}" style="margin-right:20px;"
                                             styleClass="ui-priority-primary"/>
                            </div>
                        </p:column>



                    </p:dataTable>
                </h:form>

            </div>

            <ui:include src="components/projects/StateLegendView.xhtml" />


        </div>

        <div class="col-lg-9">
            <h:panelGroup layout="block" class="row" id="projectTopicHeader">
                <c:if test="#{not projectTopicTable.projectIsSet()}">
                    <h3>Projektdetails</h3>
                </c:if>
                <c:if test="#{projectTopicTable.projectIsSet()}">
                    <h3>#{projectTopicTable.selectedProject.name}</h3>
                </c:if>
            </h:panelGroup>
            <h:panelGroup layout="block" id="stichwortPanel" class="row">
                <div class="col-lg-5 simple-card">
                    <ui:include src="topic_table.xhtml">
                        <ui:param name="updateOnDelete" value="testTable" />
                        <ui:param name="updateOnCreated" value="stichwortPanel" />
                        <ui:param name="updateOnRowSelect" value="testTable projectTopicKeywordsEmpty projectTopicHeader" />
                        <ui:param name="updateOnRowDeselect" value="testTable projectTopicKeywordsEmpty projectTopicHeader" />
                    </ui:include>
                </div>
                <div class="col-lg-1"></div>
                <div class="col-lg-5 simple-card">
                    <ui:include src="keyword_table.xhtml">
                        <ui:param name="updateOnDelete" value="testTable" />
                        <ui:param name="updateOnCreated" value="stichwortPanel" />
                        <ui:param name="updateOnRowSelect" value="testTable projectTopicKeywordsEmpty projectTopicHeader" />
                        <ui:param name="updateOnRowDeselect" value="testTable projectTopicKeywordsEmpty projectTopicHeader" />
                    </ui:include>
                </div>
            </h:panelGroup>

        </div>
    </div>
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript">
        $('.ui-panel-titlebar').on("click",function() {
            $(this).find(".ui-panel-content").toggle();

        });
    </script>
</h:body>
</html>